_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_1 (Embedding)      (None, 922, 32)           977664    
_________________________________________________________________
lstm_1 (LSTM)                (None, 922, 128)          82432     
_________________________________________________________________
time_distributed_1 (TimeDist (None, 922, 40)           5160      
=================================================================
Total params: 1,065,256.0
Trainable params: 1,065,256
Non-trainable params: 0.0

Cost function: categorical_crossentropy
Optimizer: rmsprop
Number of epoches: 20
Batch size: 32

[{'class_name': 'Embedding', 'config': {'name': 'embedding_1', 'trainable': True, 'batch_input_shape': (None, 922), 'dtype': 'int32', 'input_dim': 30552, 'output_dim': 32, 'embeddings_initializer': {'class_name': 'RandomUniform', 'config': {'minval': -0.05, 'maxval': 0.05, 'seed': None}}, 'embeddings_regularizer': None, 'activity_regularizer': None, 'embeddings_constraint': None, 'mask_zero': True, 'input_length': 922}},
{'class_name': 'LSTM', 'config': {'name': 'lstm_1', 'trainable': True, 'return_sequences': True, 'go_backwards': False, 'stateful': False, 'unroll': False, 'implementation': 0, 'units': 128, 'activation': 'tanh', 'recurrent_activation': 'hard_sigmoid', 'use_bias': True, 'kernel_initializer': {'class_name': 'VarianceScaling', 'config': {'scale': 1.0, 'mode': 'fan_avg', 'distribution': 'uniform', 'seed': None}}, 'recurrent_initializer': {'class_name': 'Orthogonal', 'config': {'gain': 1.0, 'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'unit_forget_bias': True, 'kernel_regularizer': None, 'recurrent_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'recurrent_constraint': None, 'bias_constraint': None, 'dropout': 0.0, 'recurrent_dropout': 0.0}},
{'class_name': 'TimeDistributed', 'config': {'name': 'time_distributed_1', 'trainable': True, 'layer': {'class_name': 'Dense', 'config': {'name': 'dense_1', 'trainable': True, 'units': 40, 'activation': 'softmax', 'use_bias': True, 'kernel_initializer': {'class_name': 'VarianceScaling', 'config': {'scale': 1.0, 'mode': 'fan_avg', 'distribution': 'uniform', 'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}}}]

Train on 5354 samples, validate on 5354 samples

[3672 1421  658]
{'recall': 0.84803695150115477, 'precision': 0.72098959355978798, 'f1': 0.77936962750716343}

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_1 (Embedding)      (None, 922, 100)          3055100   
_________________________________________________________________
lstm_1 (LSTM)                (None, 922, 128)          117248    
_________________________________________________________________
time_distributed_1 (TimeDist (None, 922, 40)           5160      
=================================================================
Total params: 3,177,508.0
Trainable params: 3,177,508
Non-trainable params: 0.0

Cost function: categorical_crossentropy
Optimizer: rmsprop
Number of epoches: 20
Batch size: 32

[{'class_name': 'Embedding', 'config': {'name': 'embedding_1', 'trainable': True, 'batch_input_shape': (None, 922), 'dtype': 'int32', 'input_dim': 30551, 'output_dim': 100, 'embeddings_initializer': {'class_name': 'RandomUniform', 'config': {'minval': -0.05, 'maxval': 0.05, 'seed': None}}, 'embeddings_regularizer': None, 'activity_regularizer': None, 'embeddings_constraint': None, 'mask_zero': True, 'input_length': 922}},
{'class_name': 'LSTM', 'config': {'name': 'lstm_1', 'trainable': True, 'return_sequences': True, 'go_backwards': False, 'stateful': False, 'unroll': False, 'implementation': 0, 'units': 128, 'activation': 'tanh', 'recurrent_activation': 'hard_sigmoid', 'use_bias': True, 'kernel_initializer': {'class_name': 'VarianceScaling', 'config': {'scale': 1.0, 'mode': 'fan_avg', 'distribution': 'uniform', 'seed': None}}, 'recurrent_initializer': {'class_name': 'Orthogonal', 'config': {'gain': 1.0, 'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'unit_forget_bias': True, 'kernel_regularizer': None, 'recurrent_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'recurrent_constraint': None, 'bias_constraint': None, 'dropout': 0.0, 'recurrent_dropout': 0.0}},
{'class_name': 'TimeDistributed', 'config': {'name': 'time_distributed_1', 'trainable': True, 'layer': {'class_name': 'Dense', 'config': {'name': 'dense_1', 'trainable': True, 'units': 40, 'activation': 'softmax', 'use_bias': True, 'kernel_initializer': {'class_name': 'VarianceScaling', 'config': {'scale': 1.0, 'mode': 'fan_avg', 'distribution': 'uniform', 'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}}}]

[3811 1341  519]
{'recall': 0.88013856812933022, 'precision': 0.73971273291925466, 'f1': 0.80383885256275045}
