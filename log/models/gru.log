MODEL

nb_words = 36664
max_length = 3390
embedding_dim = 20

model = Sequential()
model.add(Embedding(nb_words, embedding_dim, input_length=max_length, mask_zero=True, weights=[embedding_weights]))
model.add(GRU(256, return_sequences=True, dropout=0.2, recurrent_dropout=0.2))
model.add(TimeDistributed(Dense(encoded_Y.shape[2], activation='softmax')))

optimiser = Nadam(lr=0.002, beta_1=0.9, beta_2=0.999, epsilon=1e-08, schedule_decay=0.004)
model.compile(loss='categorical_crossentropy', optimizer=optimiser) 

model.fit(X_train, encoded_Y, epochs=40, batch_size=32, verbose=2)

                    OVERALL
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.881 (0.13)   0.8866              
                         Recall         0.911 (0.1)    0.9119              
                         F1             0.8957         0.8991              


                    CAD
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.3423 (0.46)  0.7945              
                         Recall         0.3311 (0.45)  0.8138              
                         F1             0.3366         0.804               


                    DIABETES
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.6756 (0.46)  0.9227              
                         Recall         0.6511 (0.45)  0.9203              
                         F1             0.6631         0.9215              


                    OBESE
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1466 (0.35)  0.9383              
                         Recall         0.142 (0.34)   0.8702              
                         F1             0.1443         0.903               


                    HYPERLIPIDEMIA
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.4295 (0.49)  0.9637              
                         Recall         0.4194 (0.49)  0.8828              
                         F1             0.4244         0.9215              


                    HYPERTENSION
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.6918 (0.42)  0.8679              
                         Recall         0.7127 (0.43)  0.935               
                         F1             0.7021         0.9002              


                    MEDICATION
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.7638 (0.34)  0.8898              
                         Recall         0.808 (0.34)   0.9254              
                         F1             0.7853         0.9073              


                    SMOKER
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.8035 (0.37)  0.7744              
                         Recall         0.8482 (0.36)  0.8516              
                         F1             0.8253         0.8112              


                    FAMILY_HIST
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.9572 (0.2)   0.9572              
                         Recall         0.9572 (0.2)   0.9572              
                         F1             0.9572         0.9572              


                    CAD.mention
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.3223 (0.47)  0.8367              
                         Recall         0.3268 (0.47)  0.9632              
                         F1             0.3246         0.8955              


                    CAD.event
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1946 (0.4)   0.7463              
                         Recall         0.1926 (0.39)  0.7194              
                         F1             0.1936         0.7326              


                    CAD.test
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.06226 (0.24) 0.64                
                         Recall         0.05934 (0.23) 0.5424              
                         F1             0.06076        0.5872              


                    CAD.symptom
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.01751 (0.13) 0.36                
                         Recall         0.01556 (0.12) 0.1286              
                         F1             0.01648        0.1895              


                    DIABETES.mention
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.6809 (0.47)  0.9309              
                         Recall         0.6829 (0.47)  0.9859              
                         F1             0.6819         0.9576              


                    DIABETES.a1c
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.07004 (0.26) 0.75                
                         Recall         0.06907 (0.25) 0.439               
                         F1             0.06955        0.5538              


                    DIABETES.glucose
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


                    OBESE.mention
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1466 (0.35)  0.9417              
                         Recall         0.1479 (0.35)  0.9224              
                         F1             0.1472         0.932               


                    OBESE.bmi
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.003891 (0.062)0.6667              
                         Recall         0.003891 (0.062)0.1176              
                         F1             0.003891       0.2                 


                    HYPERLIPIDEMIA.mention
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.43 (0.5)     0.9651              
                         Recall         0.43 (0.5)     0.9325              
                         F1             0.43           0.9485              


                    HYPERLIPIDEMIA.high_ldl
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


                    HYPERLIPIDEMIA.high_chol
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


                    HYPERTENSION.mention
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.7023 (0.46)  0.9601              
                         Recall         0.7062 (0.46)  0.9863              
                         F1             0.7043         0.973               


                    HYPERTENSION.high_bp
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.2432 (0.43)  0.4755              
                         Recall         0.2354 (0.42)  0.6462              
                         F1             0.2392         0.5478              


                    MEDICATION.ace_inhibitor
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.3729 (0.48)  0.8752              
                         Recall         0.3911 (0.49)  0.935               
                         F1             0.3818         0.9041              


                    MEDICATION.anti_diabetes
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


                    MEDICATION.arb
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.08949 (0.28) 0.92                
                         Recall         0.09339 (0.29) 0.715               
                         F1             0.0914         0.8047              


                    MEDICATION.aspirin
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.5143 (0.49)  0.9145              
                         Recall         0.5409 (0.5)   0.9912              
                         F1             0.5272         0.9513              


                    MEDICATION.beta_blocker
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.5123 (0.49)  0.908               
                         Recall         0.5409 (0.5)   0.9461              
                         F1             0.5262         0.9267              


                    MEDICATION.calcium_channel_blocker
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.2367 (0.42)  0.908               
                         Recall         0.2529 (0.43)  0.9481              
                         F1             0.2445         0.9276              


                    MEDICATION.diuretic
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1336 (0.33)  0.816               
                         Recall         0.1435 (0.35)  0.8031              
                         F1             0.1384         0.8095              


                    MEDICATION.dpp4_inhibitors
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


                    MEDICATION.ezetimibe
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


                    MEDICATION.fibrate
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.01751 (0.13) 1.0                 
                         Recall         0.01751 (0.13) 0.3                 
                         F1             0.01751        0.4615              


                    MEDICATION.insulin
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.2497 (0.43)  0.828               
                         Recall         0.2626 (0.44)  0.9747              
                         F1             0.256          0.8953              


                    MEDICATION.metformin
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.2309 (0.41)  0.8537              
                         Recall         0.2558 (0.44)  0.9596              
                         F1             0.2427         0.9036              


                    MEDICATION.niacin
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


                    MEDICATION.nitrate
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1524 (0.35)  0.8435              
                         Recall         0.1621 (0.37)  0.8155              
                         F1             0.1571         0.8293              


                    MEDICATION.statin
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.5188 (0.49)  0.9292              
                         Recall         0.537 (0.5)    0.9792              
                         F1             0.5277         0.9535              


                    MEDICATION.sulfonylureas
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1706 (0.37)  0.8946              
                         Recall         0.177 (0.38)   0.9132              
                         F1             0.1737         0.9038              


                    MEDICATION.thiazolidinedione
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.03761 (0.19) 0.8056              
                         Recall         0.0428 (0.2)   0.9508              
                         F1             0.04004        0.8722              


                    MEDICATION.thienopyridine
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1803 (0.38)  0.8997              
                         Recall         0.1946 (0.4)   0.9789              
                         F1             0.1871         0.9376              


                    SMOKER.current
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.01362 (0.12) 0.6364              
                         Recall         0.01362 (0.12) 0.2121              
                         F1             0.01362        0.3182              


                    SMOKER.past
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1868 (0.39)  0.64                
                         Recall         0.1868 (0.39)  0.8496              
                         F1             0.1868         0.73                


                    SMOKER.ever
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


                    SMOKER.never
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1926 (0.39)  0.7444              
                         Recall         0.1926 (0.39)  0.825               
                         F1             0.1926         0.7826              


                    SMOKER.unknown
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.4553 (0.5)   0.8699              
                         Recall         0.4553 (0.5)   0.963               
                         F1             0.4553         0.9141              


                    FAMILY_HIST.present
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


                    FAMILY_HIST.not_present
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.9572 (0.2)   0.9628              
                         Recall         0.9572 (0.2)   0.9939              
                         F1             0.9572         0.9781              
