MODEL

nb_words = 36664
max_length = 3390
embedding_dim = 20

model = Sequential()
model.add(Embedding(nb_words, embedding_dim, input_length=max_length, mask_zero=True, weights=[embedding_weights]))
model.add(GRU(256, return_sequences=True, dropout=0.2, recurrent_dropout=0.2))
model.add(TimeDistributed(Dense(encoded_Y.shape[2], activation='softmax')))

optimiser = Nadam(lr=0.002, beta_1=0.9, beta_2=0.999, epsilon=1e-08, schedule_decay=0.004)
model.compile(loss='categorical_crossentropy', optimizer=optimiser) 

model.fit(X_train, encoded_Y, epochs=40, batch_size=32, verbose=2)

                    OVERALL
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.881 (0.13)   0.8866              
                         Recall         0.911 (0.1)    0.9119              
                         F1             0.8957         0.8991              


                    CAD
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.3423 (0.46)  0.7945              
                         Recall         0.3311 (0.45)  0.8138              
                         F1             0.3366         0.804               


                    DIABETES
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.6756 (0.46)  0.9227              
                         Recall         0.6511 (0.45)  0.9203              
                         F1             0.6631         0.9215              


                    OBESE
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1466 (0.35)  0.9383              
                         Recall         0.142 (0.34)   0.8702              
                         F1             0.1443         0.903               


                    HYPERLIPIDEMIA
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.4295 (0.49)  0.9637              
                         Recall         0.4194 (0.49)  0.8828              
                         F1             0.4244         0.9215              


                    HYPERTENSION
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.6918 (0.42)  0.8679              
                         Recall         0.7127 (0.43)  0.935               
                         F1             0.7021         0.9002              


                    MEDICATION
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.7638 (0.34)  0.8898              
                         Recall         0.808 (0.34)   0.9254              
                         F1             0.7853         0.9073              


                    SMOKER
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.8035 (0.37)  0.7744              
                         Recall         0.8482 (0.36)  0.8516              
                         F1             0.8253         0.8112              


                    FAMILY_HIST
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.9572 (0.2)   0.9572              
                         Recall         0.9572 (0.2)   0.9572              
                         F1             0.9572         0.9572              


                    CAD.mention
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.3223 (0.47)  0.8367              
                         Recall         0.3268 (0.47)  0.9632              
                         F1             0.3246         0.8955              


                    CAD.event
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1946 (0.4)   0.7463              
                         Recall         0.1926 (0.39)  0.7194              
                         F1             0.1936         0.7326              


                    CAD.test
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.06226 (0.24) 0.64                
                         Recall         0.05934 (0.23) 0.5424              
                         F1             0.06076        0.5872              


                    CAD.symptom
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.01751 (0.13) 0.36                
                         Recall         0.01556 (0.12) 0.1286              
                         F1             0.01648        0.1895              


                    DIABETES.mention
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.6809 (0.47)  0.9309              
                         Recall         0.6829 (0.47)  0.9859              
                         F1             0.6819         0.9576              


                    DIABETES.a1c
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.07004 (0.26) 0.75                
                         Recall         0.06907 (0.25) 0.439               
                         F1             0.06955        0.5538              


                    DIABETES.glucose
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


                    OBESE.mention
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1466 (0.35)  0.9417              
                         Recall         0.1479 (0.35)  0.9224              
                         F1             0.1472         0.932               


                    OBESE.bmi
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.003891 (0.062)0.6667              
                         Recall         0.003891 (0.062)0.1176              
                         F1             0.003891       0.2                 


                    HYPERLIPIDEMIA.mention
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.43 (0.5)     0.9651              
                         Recall         0.43 (0.5)     0.9325              
                         F1             0.43           0.9485              


                    HYPERLIPIDEMIA.high_ldl
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


                    HYPERLIPIDEMIA.high_chol
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


                    HYPERTENSION.mention
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.7023 (0.46)  0.9601              
                         Recall         0.7062 (0.46)  0.9863              
                         F1             0.7043         0.973               


                    HYPERTENSION.high_bp
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.2432 (0.43)  0.4755              
                         Recall         0.2354 (0.42)  0.6462              
                         F1             0.2392         0.5478              


                    MEDICATION.ace_inhibitor
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.3729 (0.48)  0.8752              
                         Recall         0.3911 (0.49)  0.935               
                         F1             0.3818         0.9041              


                    MEDICATION.anti_diabetes
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


                    MEDICATION.arb
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.08949 (0.28) 0.92                
                         Recall         0.09339 (0.29) 0.715               
                         F1             0.0914         0.8047              


                    MEDICATION.aspirin
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.5143 (0.49)  0.9145              
                         Recall         0.5409 (0.5)   0.9912              
                         F1             0.5272         0.9513              


                    MEDICATION.beta_blocker
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.5123 (0.49)  0.908               
                         Recall         0.5409 (0.5)   0.9461              
                         F1             0.5262         0.9267              


                    MEDICATION.calcium_channel_blocker
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.2367 (0.42)  0.908               
                         Recall         0.2529 (0.43)  0.9481              
                         F1             0.2445         0.9276              


                    MEDICATION.diuretic
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1336 (0.33)  0.816               
                         Recall         0.1435 (0.35)  0.8031              
                         F1             0.1384         0.8095              


                    MEDICATION.dpp4_inhibitors
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


                    MEDICATION.ezetimibe
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


                    MEDICATION.fibrate
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.01751 (0.13) 1.0                 
                         Recall         0.01751 (0.13) 0.3                 
                         F1             0.01751        0.4615              


                    MEDICATION.insulin
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.2497 (0.43)  0.828               
                         Recall         0.2626 (0.44)  0.9747              
                         F1             0.256          0.8953              


                    MEDICATION.metformin
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.2309 (0.41)  0.8537              
                         Recall         0.2558 (0.44)  0.9596              
                         F1             0.2427         0.9036              


                    MEDICATION.niacin
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


                    MEDICATION.nitrate
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1524 (0.35)  0.8435              
                         Recall         0.1621 (0.37)  0.8155              
                         F1             0.1571         0.8293              


                    MEDICATION.statin
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.5188 (0.49)  0.9292              
                         Recall         0.537 (0.5)    0.9792              
                         F1             0.5277         0.9535              


                    MEDICATION.sulfonylureas
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1706 (0.37)  0.8946              
                         Recall         0.177 (0.38)   0.9132              
                         F1             0.1737         0.9038              


                    MEDICATION.thiazolidinedione
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.03761 (0.19) 0.8056              
                         Recall         0.0428 (0.2)   0.9508              
                         F1             0.04004        0.8722              


                    MEDICATION.thienopyridine
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1803 (0.38)  0.8997              
                         Recall         0.1946 (0.4)   0.9789              
                         F1             0.1871         0.9376              


                    SMOKER.current
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.01362 (0.12) 0.6364              
                         Recall         0.01362 (0.12) 0.2121              
                         F1             0.01362        0.3182              


                    SMOKER.past
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1868 (0.39)  0.64                
                         Recall         0.1868 (0.39)  0.8496              
                         F1             0.1868         0.73                


                    SMOKER.ever
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


                    SMOKER.never
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1926 (0.39)  0.7444              
                         Recall         0.1926 (0.39)  0.825               
                         F1             0.1926         0.7826              


                    SMOKER.unknown
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.4553 (0.5)   0.8699              
                         Recall         0.4553 (0.5)   0.963               
                         F1             0.4553         0.9141              


                    FAMILY_HIST.present
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


                    FAMILY_HIST.not_present
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.9572 (0.2)   0.9628              
                         Recall         0.9572 (0.2)   0.9939              
                         F1             0.9572         0.9781            

MODEL

nb_words = 36664
max_length = 3390
embedding_dim = 20

model = Sequential()
model.add(Embedding(nb_words, embedding_dim, input_length=max_length, mask_zero=True, weights=[embedding_weights]))
model.add(GRU(256, return_sequences=True, dropout=0.1, recurrent_dropout=0.1))
model.add(TimeDistributed(Dense(encoded_Y.shape[2], activation='softmax')))

optimiser = Nadam(lr=0.002, beta_1=0.9, beta_2=0.999, epsilon=1e-08, schedule_decay=0.004)
model.compile(loss='categorical_crossentropy', optimizer=optimiser) 

model.fit(X_train, encoded_Y, epochs=50, batch_size=32, verbose=2)


                    OVERALL
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.8724 (0.14)  0.8799              
                         Recall         0.9222 (0.1)   0.9265              
                         F1             0.8966         0.9026              

                    CAD
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.3451 (0.45)  0.7733              
                         Recall         0.3532 (0.46)  0.8571              
                         F1             0.3491         0.8131              

                    DIABETES
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.6642 (0.46)  0.9052              
                         Recall         0.6469 (0.45)  0.9144              
                         F1             0.6554         0.9098              

                    OBESE
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1492 (0.36)  0.8919              
                         Recall         0.1454 (0.35)  0.8817              
                         F1             0.1473         0.8868              

                    HYPERLIPIDEMIA
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.427 (0.49)   0.9538              
                         Recall         0.4179 (0.49)  0.8802              
                         F1             0.4224         0.9155              

                    HYPERTENSION
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.6956 (0.42)  0.8754              
                         Recall         0.719 (0.43)   0.9404              
                         F1             0.7071         0.9068              

                    MEDICATION
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.7568 (0.35)  0.8865              
                         Recall         0.8205 (0.34)  0.9475              
                         F1             0.7874         0.916               

                    SMOKER
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.8022 (0.37)  0.7636              
                         Recall         0.8482 (0.36)  0.8516              
                         F1             0.8246         0.8052              

                    FAMILY_HIST
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.9591 (0.2)   0.9591              
                         Recall         0.9591 (0.2)   0.9591              
                         F1             0.9591         0.9591              

                    CAD.mention
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.323 (0.47)   0.8384              
                         Recall         0.3288 (0.47)  0.9651              
                         F1             0.3258         0.8973              

                    CAD.event
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.2218 (0.42)  0.6951              
                         Recall         0.2189 (0.41)  0.8201              
                         F1             0.2203         0.7525              

                    CAD.test
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.07782 (0.27) 0.6269              
                         Recall         0.07685 (0.27) 0.7119              
                         F1             0.07733        0.6667              

                    CAD.symptom
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.03307 (0.18) 0.4091              
                         Recall         0.0308 (0.17)  0.2571              
                         F1             0.0319         0.3158              

                    DIABETES.mention
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.677 (0.47)   0.928               
                         Recall         0.679 (0.47)   0.9803              
                         F1             0.678          0.9534              

                    DIABETES.a1c
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0642 (0.25)  0.5893              
                         Recall         0.06226 (0.24) 0.4024              
                         F1             0.06321        0.4783              

                    DIABETES.glucose
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.003891 (0.062)0.1818              
                         Recall         0.003891 (0.062)0.06061             
                         F1             0.003891       0.09091             

                    OBESE.mention
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1492 (0.36)  0.902               
                         Recall         0.1518 (0.36)  0.9388              
                         F1             0.1504         0.92                

                    OBESE.bmi
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.001946 (0.044)0.25                
                         Recall         0.001946 (0.044)0.05882             
                         F1             0.001946       0.09524             

                    HYPERLIPIDEMIA.mention
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.428 (0.49)   0.9565              
                         Recall         0.428 (0.49)   0.9283              
                         F1             0.428          0.9422              

                    HYPERLIPIDEMIA.high_ldl
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.001946 (0.044)0.3333              
                         Recall         0.001946 (0.044)0.03448             
                         F1             0.001946       0.0625              

                    HYPERLIPIDEMIA.high_chol
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 

                    HYPERTENSION.mention
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.7043 (0.45)  0.9679              
                         Recall         0.7082 (0.45)  0.9891              
                         F1             0.7062         0.9784              

                    HYPERTENSION.high_bp
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.251 (0.43)   0.4869              
                         Recall         0.2442 (0.42)  0.6667              
                         F1             0.2475         0.5628              

                    MEDICATION.ace_inhibitor
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.3716 (0.48)  0.8884              
                         Recall         0.3911 (0.49)  0.9317              
                         F1             0.3811         0.9095              

                    MEDICATION.anti_diabetes
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 

                    MEDICATION.arb
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1031 (0.3)   0.9138              
                         Recall         0.107 (0.31)   0.8238              
                         F1             0.105          0.8665              

                    MEDICATION.aspirin
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.5078 (0.49)  0.9115              
                         Recall         0.5311 (0.5)   0.9812              
                         F1             0.5192         0.9451              

                    MEDICATION.beta_blocker
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.5259 (0.49)  0.907               
                         Recall         0.5584 (0.5)   0.9689              
                         F1             0.5417         0.9369              

                    MEDICATION.calcium_channel_blocker
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.2374 (0.42)  0.9104              
                         Recall         0.2549 (0.44)  0.9506              
                         F1             0.2458         0.9301              

                    MEDICATION.diuretic
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1329 (0.33)  0.7946              
                         Recall         0.1454 (0.35)  0.8071              
                         F1             0.1389         0.8008              

                    MEDICATION.dpp4_inhibitors
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 

                    MEDICATION.ezetimibe
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.01167 (0.11) 1.0                 
                         Recall         0.01167 (0.11) 0.5                 
                         F1             0.01167        0.6667              

                    MEDICATION.fibrate
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.04994 (0.22) 0.8556              
                         Recall         0.05253 (0.22) 0.8556              
                         F1             0.0512         0.8556              

                    MEDICATION.insulin
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.2516 (0.43)  0.8186              
                         Recall         0.2646 (0.44)  0.9823              
                         F1             0.2579         0.893               

                    MEDICATION.metformin
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.2309 (0.41)  0.8537              
                         Recall         0.2558 (0.44)  0.9596              
                         F1             0.2427         0.9036              

                   MEDICATION.niacin
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 

                    MEDICATION.nitrate
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1663 (0.37)  0.7947              
                         Recall         0.1787 (0.38)  0.8856              
                         F1             0.1723         0.8377              

                    MEDICATION.statin
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.5188 (0.49)  0.9292              
                         Recall         0.537 (0.5)    0.9792              
                         F1             0.5277         0.9535              

                    MEDICATION.sulfonylureas
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1725 (0.37)  0.8867              
                         Recall         0.179 (0.38)   0.9236              
                         F1             0.1757         0.9048              

                    MEDICATION.thiazolidinedione
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.03761 (0.19) 0.8406              
                         Recall         0.0428 (0.2)   0.9508              
                         F1             0.04004        0.8923              

                    MEDICATION.thienopyridine
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1803 (0.38)  0.9175              
                         Recall         0.1946 (0.4)   0.9789              
                         F1             0.1871         0.9472              

                    SMOKER.current
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0214 (0.14)  0.7333              
                         Recall         0.0214 (0.14)  0.3333              
                         F1             0.0214         0.4583              

                    SMOKER.past
---------------------------------------------------------------------------
           (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1887 (0.39)  0.5988              
                         Recall         0.1887 (0.39)  0.8584              
                         F1             0.1887         0.7055              

                    SMOKER.ever
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 

                    SMOKER.never
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1868 (0.39)  0.7273              
                         Recall         0.1868 (0.39)  0.8                 
                         F1             0.1868         0.7619              

                    SMOKER.unknown
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.4514 (0.5)   0.8855              
                         Recall         0.4514 (0.5)   0.9547              
                         F1             0.4514         0.9188              

                    FAMILY_HIST.present
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.003891 (0.062)0.3333              
                         Recall         0.003891 (0.062)0.1053              
                         F1             0.003891       0.16                

                    FAMILY_HIST.not_present
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.9553 (0.21)  0.9665              
                         Recall         0.9553 (0.21)  0.9919              
                         F1             0.9553         0.9791      

MODEL

nb_words = 36664
max_length = 3390
embedding_dim = 20

model = Sequential()
model.add(Embedding(nb_words, embedding_dim, input_length=max_length, mask_zero=True, weights=[embedding_weights]))
model.add(GRU(256, return_sequences=True, dropout=0.1, recurrent_dropout=0.1))
model.add(TimeDistributed(Dense(encoded_Y.shape[2], activation='softmax')))

optimiser = Nadam(lr=0.002, beta_1=0.9, beta_2=0.999, epsilon=1e-08, schedule_decay=0.004)
model.compile(loss='categorical_crossentropy', optimizer=optimiser) 

model.fit(X_train, encoded_Y, epochs=50, batch_size=32, verbose=2)

                    OVERALL
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.8936 (0.12)  0.8977              
                         Recall         0.9081 (0.11)  0.9099              
                         F1             0.9008         0.9038              

                    CAD
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.3334 (0.45)  0.8031              
                         Recall         0.3273 (0.45)  0.7908              
                         F1             0.3303         0.7969              

                    DIABETES
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.6657 (0.47)  0.9408              
                         Recall         0.638 (0.45)   0.9017              
                         F1             0.6516         0.9208              

                    OBESE
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1487 (0.35)  0.9102              
                         Recall         0.1464 (0.35)  0.8893              
                         F1             0.1475         0.8996              

                    HYPERLIPIDEMIA
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.4217 (0.49)  0.966               
                         Recall         0.413 (0.49)   0.8708              
                         F1             0.4173         0.916               

                    HYPERTENSION
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.6924 (0.43)  0.8925              
                         Recall         0.7033 (0.43)  0.925               
                         F1             0.6978         0.9085              

                    MEDICATION
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.7701 (0.35)  0.9009              
                         Recall         0.8097 (0.34)  0.9323              
                         F1             0.7894         0.9163              

                    SMOKER
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.8051 (0.37)  0.776               
                         Recall         0.8424 (0.36)  0.8457              
                         F1             0.8233         0.8093              

                    FAMILY_HIST
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.9572 (0.2)   0.9572              
                         Recall         0.9572 (0.2)   0.9572              
                         F1             0.9572         0.9572              

                    CAD.mention
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.3087 (0.46)  0.8864              
                         Recall         0.3132 (0.46)  0.9225              
                         F1             0.3109         0.9041              

                    CAD.event
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.2091 (0.41)  0.6943              
                         Recall         0.2091 (0.41)  0.7842              
                         F1             0.2091         0.7365              

                    CAD.test
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.04475 (0.21) 0.5333              
                         Recall         0.04377 (0.2)  0.4068              
                         F1             0.04426        0.4615              

                    CAD.symptom
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.02043 (0.14) 0.3333              
                         Recall         0.01816 (0.13) 0.1571              
                         F1             0.01923        0.2136              

                    DIABETES.mention
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.6693 (0.47)  0.9503              
                         Recall         0.6712 (0.47)  0.969               
                         F1             0.6702         0.9596              

                    DIABETES.a1c
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.05837 (0.23) 0.7692              
                         Recall         0.05739 (0.23) 0.3659              
                         F1             0.05788        0.4959              

                    DIABETES.glucose
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.003891 (0.062)0.3333              
                         Recall         0.002918 (0.049)0.06061             
                         F1             0.003335       0.1026              

                    OBESE.mention
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1492 (0.36)  0.9237              
                         Recall         0.1518 (0.36)  0.9388              
                         F1             0.1504         0.9312              

                    OBESE.bmi
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.005837 (0.076)0.4286              
                         Recall         0.005837 (0.076)0.1765              
                         F1             0.005837       0.25                

                    HYPERLIPIDEMIA.mention
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.4222 (0.49)  0.9688              
                         Recall         0.4222 (0.49)  0.9156              
                         F1             0.4222         0.9414              

                    HYPERLIPIDEMIA.high_ldl
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.005837 (0.076)0.6                 
                         Recall         0.005837 (0.076)0.1034              
                         F1             0.005837       0.1765              

                    HYPERLIPIDEMIA.high_chol
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 

                    HYPERTENSION.mention
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.6984 (0.46)  0.9755              
                         Recall         0.7023 (0.46)  0.9809              
                         F1             0.7004         0.9782              

                    HYPERTENSION.high_bp
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.2276 (0.42)  0.5042              
                         Recall         0.2218 (0.41)  0.6103              
                         F1             0.2247         0.5522              

                    MEDICATION.ace_inhibitor
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.3671 (0.47)  0.9248              
                         Recall         0.3852 (0.49)  0.9203              
                         F1             0.3759         0.9226              

                    MEDICATION.anti_diabetes
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 

                    MEDICATION.arb
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1064 (0.31)  0.9266              
                         Recall         0.1109 (0.31)  0.8497              
                         F1             0.1086         0.8865              

                    MEDICATION.aspirin
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.5058 (0.49)  0.9317              
                         Recall         0.5253 (0.5)   0.9749              
                         F1             0.5154         0.9528              

                    MEDICATION.beta_blocker
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.5246 (0.49)  0.8959              
                         Recall         0.5584 (0.5)   0.9689              
                         F1             0.541          0.931               


                    MEDICATION.calcium_channel_blocker
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.2387 (0.42)  0.9132              
                         Recall         0.2549 (0.44)  0.9558              
                         F1             0.2465         0.934               

                    MEDICATION.diuretic
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1349 (0.33)  0.8193              
                         Recall         0.1448 (0.35)  0.8031              
                         F1             0.1397         0.8111              

                    MEDICATION.dpp4_inhibitors
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 

                    MEDICATION.ezetimibe
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.001946 (0.044)1.0                 
                         Recall         0.001946 (0.044)0.08333             
                         F1             0.001946       0.1538              

                    MEDICATION.fibrate
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.04086 (0.2)  1.0                 
                         Recall         0.04086 (0.2)  0.7                 
                         F1             0.04086        0.8235              

                    MEDICATION.insulin
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.2451 (0.43)  0.8514              
                         Recall         0.2568 (0.44)  0.957               
                         F1             0.2508         0.9011              

                    MEDICATION.metformin
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.2309 (0.41)  0.8662              
                         Recall         0.2558 (0.44)  0.9596              
                         F1             0.2427         0.9105              

                    MEDICATION.niacin
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 

                    MEDICATION.nitrate
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1621 (0.36)  0.8201              
                         Recall         0.1709 (0.38)  0.8413              
                         F1             0.1664         0.8306              

                    MEDICATION.statin
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.5058 (0.49)  0.9386              
                         Recall         0.5214 (0.5)   0.9547              
                         F1             0.5135         0.9466              

                    MEDICATION.sulfonylureas
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1712 (0.37)  0.8889              
                         Recall         0.179 (0.38)   0.9167              
                         F1             0.175          0.9026              

                    MEDICATION.thiazolidinedione
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.03761 (0.19) 0.8406              
                         Recall         0.0428 (0.2)   0.9508              
                         F1             0.04004        0.8923              

                    MEDICATION.thienopyridine
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1757 (0.37)  0.9125              
                         Recall         0.1887 (0.39)  0.9542              
                         F1             0.182          0.9329              

                    SMOKER.current
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.02335 (0.15) 0.5455              
                         Recall         0.02335 (0.15) 0.3636              
                         F1             0.02335        0.4364              

                    SMOKER.past
---------------------------------------------------------------------------
           (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1732 (0.38)  0.6899              
                         Recall         0.1732 (0.38)  0.7876              
                         F1             0.1732         0.7355              

                    SMOKER.ever
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 

                    SMOKER.never
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1848 (0.39)  0.748               
                         Recall         0.1848 (0.39)  0.7917              
                         F1             0.1848         0.7692              

                    SMOKER.unknown
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.4611 (0.5)   0.8464              
                         Recall         0.4611 (0.5)   0.9753              
                         F1             0.4611         0.9063              

                    FAMILY_HIST.present
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.001946 (0.044)0.2                 
                         Recall         0.001946 (0.044)0.05263             
                         F1             0.001946       0.08333             

                    FAMILY_HIST.not_present
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.9553 (0.21)  0.9646              
                         Recall         0.9553 (0.21)  0.9919              
                         F1             0.9553         0.9781              
