MODEL

nb_words = 36664
max_length = 3390
embedding_dim = 20

model = Sequential()
model.add(Embedding(nb_words, embedding_dim, input_length=max_length, mask_zero=True, weights=[embedding_weights]))
model.add(SimpleRNN(256, return_sequences=True, dropout=0.1, recurrent_dropout=0.2))
model.add(TimeDistributed(Dense(encoded_Y.shape[2], activation='softmax')))

optimiser = Nadam(lr=0.002, beta_1=0.9, beta_2=0.999, epsilon=1e-08, schedule_decay=0.004)
model.compile(loss='categorical_crossentropy', optimizer=optimiser) 

model.fit(X_train, encoded_Y, epochs=30, batch_size=32, verbose=2)

				OVERALL
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.8813 (0.13)  0.885               
                         Recall         0.8875 (0.12)  0.8854              
                         F1             0.8844         0.8852              


				CAD
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.3443 (0.46)  0.764               
                         Recall         0.3426 (0.45)  0.838               
                         F1             0.3434         0.7993              


				DIABETES
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.679 (0.46)   0.9334              
                         Recall         0.6568 (0.45)  0.9271              
                         F1             0.6677         0.9303              


				OBESE
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1511 (0.36)  0.863               
                         Recall         0.1508 (0.35)  0.8893              
                         F1             0.1509         0.8759              


				HYPERLIPIDEMIA
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.4339 (0.5)   0.953               
                         Recall         0.4232 (0.49)  0.8908              
                         F1             0.4285         0.9209              


				HYPERTENSION
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.6975 (0.42)  0.8673              
                         Recall         0.731 (0.43)   0.9551              
                         F1             0.7138         0.9091              


				MEDICATION
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.7553 (0.36)  0.8928              
                         Recall         0.7564 (0.34)  0.8657              
                         F1             0.7558         0.879               


				SMOKER
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.7977 (0.39)  0.7872              
                         Recall         0.8132 (0.39)  0.8164              
                         F1             0.8054         0.8015              


				FAMILY_HIST
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.963 (0.19)   0.963               
                         Recall         0.963 (0.19)   0.963               
                         F1             0.963          0.963               


				CAD.mention
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.3268 (0.47)  0.7814              
                         Recall         0.3327 (0.47)  0.9767              
                         F1             0.3297         0.8682              


				CAD.event
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.2198 (0.41)  0.7386              
                         Recall         0.2179 (0.41)  0.8129              
                         F1             0.2189         0.774               


				CAD.test
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.07393 (0.26) 0.6441              
                         Recall         0.07004 (0.25) 0.6441              
                         F1             0.07193        0.6441              


				CAD.symptom
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.003891 (0.062)0.6667              
                         Recall         0.003891 (0.062)0.02857             
                         F1             0.003891       0.05479             


				DIABETES.mention
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.6829 (0.46)  0.941               
                         Recall         0.6848 (0.46)  0.9887              
                         F1             0.6839         0.9643              


				DIABETES.a1c
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.07977 (0.27) 0.7736              
                         Recall         0.07782 (0.27) 0.5                 
                         F1             0.07878        0.6074              


				DIABETES.glucose
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


				OBESE.mention
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1511 (0.36)  0.863               
                         Recall         0.1576 (0.36)  0.951               
                         F1             0.1543         0.9049              


				OBESE.bmi
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


				HYPERLIPIDEMIA.mention
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.4339 (0.5)   0.953               
                         Recall         0.4339 (0.5)   0.9409              
                         F1             0.4339         0.9469              


				HYPERLIPIDEMIA.high_ldl
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


				HYPERLIPIDEMIA.high_chol
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


				HYPERTENSION.mention
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.7043 (0.45)  0.9577              
                         Recall         0.7082 (0.45)  0.9891              
                         F1             0.7062         0.9731              


				HYPERTENSION.high_bp
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.2899 (0.45)  0.5138              
                         Recall         0.2792 (0.44)  0.7641              
                         F1             0.2844         0.6144              


				MEDICATION.ace_inhibitor
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.3547 (0.47)  0.8851              
                         Recall         0.3716 (0.48)  0.8894              
                         F1             0.363          0.8873              


				MEDICATION.anti_diabetes
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


				MEDICATION.arb
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.008431 (0.089)0.8667              
                         Recall         0.009728 (0.098)0.06736             
                         F1             0.009033       0.125               


				MEDICATION.aspirin
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.513 (0.49)   0.9092              
                         Recall         0.5409 (0.5)   0.9912              
                         F1             0.5265         0.9484              


				MEDICATION.beta_blocker
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.5182 (0.49)  0.8937              
                         Recall         0.5506 (0.5)   0.9569              
                         F1             0.5339         0.9242              


				MEDICATION.calcium_channel_blocker
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.2205 (0.41)  0.9366              
                         Recall         0.2315 (0.42)  0.8831              
                         F1             0.2259         0.9091              


				MEDICATION.diuretic
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.09792 (0.29) 0.8251              
                         Recall         0.1075 (0.31)  0.5945              
                         F1             0.1025         0.6911              


				MEDICATION.dpp4_inhibitors
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


				MEDICATION.ezetimibe
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


				MEDICATION.fibrate
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


				MEDICATION.insulin
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.2497 (0.43)  0.8556              
                         Recall         0.2626 (0.44)  0.9747              
                         F1             0.256          0.9112              


				MEDICATION.metformin
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.2309 (0.41)  0.8599              
                         Recall         0.2558 (0.44)  0.9596              
                         F1             0.2427         0.907               


				MEDICATION.niacin
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


				MEDICATION.nitrate
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1505 (0.35)  0.7657              
                         Recall         0.1712 (0.38)  0.8561              
                         F1             0.1602         0.8084              


				MEDICATION.statin
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.489 (0.49)   0.9449              
                         Recall         0.5058 (0.5)   0.9229              
                         F1             0.4973         0.9337              


				MEDICATION.sulfonylureas
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1608 (0.36)  0.9394              
                         Recall         0.1673 (0.37)  0.8611              
                         F1             0.164          0.8986              


				MEDICATION.thiazolidinedione
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.01621 (0.12) 0.8333              
                         Recall         0.01751 (0.13) 0.4098              
                         F1             0.01684        0.5495              


				MEDICATION.thienopyridine
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1757 (0.37)  0.9033              
                         Recall         0.1887 (0.39)  0.9542              
                         F1             0.182          0.9281              


				SMOKER.current
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


				SMOKER.past
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.2043 (0.4)   0.6562              
                         Recall         0.2043 (0.4)   0.9292              
                         F1             0.2043         0.7692              


				SMOKER.ever
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


				SMOKER.never
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1459 (0.35)  0.8721              
                         Recall         0.1459 (0.35)  0.625               
                         F1             0.1459         0.7282              


				SMOKER.unknown
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.463 (0.5)    0.8351              
                         Recall         0.463 (0.5)    0.9794              
                         F1             0.463          0.9015              


				FAMILY_HIST.present
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


				FAMILY_HIST.not_present
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.963 (0.19)   0.963               
                         Recall         0.963 (0.19)   1.0                 
                         F1             0.963          0.9812   

MODEL

nb_words = 36664
max_length = 3390
embedding_dim = 20

model = Sequential()
model.add(Embedding(nb_words, embedding_dim, input_length=max_length, mask_zero=True, weights=[embedding_weights]))
model.add(SimpleRNN(128, return_sequences=True, dropout=0.1, recurrent_dropout=0.1))
model.add(TimeDistributed(Dense(encoded_Y.shape[2], activation='softmax')))

optimiser = Nadam(lr=0.002, beta_1=0.9, beta_2=0.999, epsilon=1e-08, schedule_decay=0.004)
model.compile(loss='categorical_crossentropy', optimizer=optimiser) 

model.fit(X_train, encoded_Y, epochs=40, batch_size=32, verbose=2)    

                    OVERALL
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.8798 (0.14)  0.8844              
                         Recall         0.8977 (0.11)  0.8956              
                         F1             0.8887         0.89                


                    CAD
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.339 (0.45)   0.754               
                         Recall         0.3417 (0.45)  0.8444              
                         F1             0.3404         0.7966              


                    DIABETES
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.6809 (0.46)  0.9348              
                         Recall         0.6475 (0.45)  0.911               
                         F1             0.6638         0.9227              


                    OBESE
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.155 (0.36)   0.8386              
                         Recall         0.1586 (0.36)  0.9122              
                         F1             0.1568         0.8739              


                    HYPERLIPIDEMIA
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.43 (0.5)     0.9609              
                         Recall         0.4198 (0.49)  0.8842              
                         F1             0.4248         0.9209              


                    HYPERTENSION
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.7025 (0.42)  0.8722              
                         Recall         0.7278 (0.42)  0.9497              
                         F1             0.7149         0.9093              


                    MEDICATION
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.7639 (0.35)  0.8916              
                         Recall         0.7848 (0.34)  0.8886              
                         F1             0.7742         0.8901              


                    SMOKER
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.8035 (0.39)  0.7955              
                         Recall         0.8171 (0.39)  0.8203              
                         F1             0.8103         0.8077              


                    FAMILY_HIST
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.963 (0.19)   0.963               
                         Recall         0.963 (0.19)   0.963               
                         F1             0.963          0.963               


                    CAD.mention
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.3268 (0.47)  0.7814              
                         Recall         0.3327 (0.47)  0.9767              
                         F1             0.3297         0.8682              


                    CAD.event
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.2121 (0.41)  0.7365              
                         Recall         0.2101 (0.41)  0.7842              
                         F1             0.2111         0.7596              


                    CAD.test
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.08171 (0.27) 0.5915              
                         Recall         0.07782 (0.26) 0.7119              
                         F1             0.07972        0.6462              


                    CAD.symptom
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.01362 (0.12) 0.5                 
                         Recall         0.01135 (0.1)  0.1                 
                         F1             0.01238        0.1667              


                    DIABETES.mention
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.6809 (0.47)  0.9383              
                         Recall         0.6829 (0.47)  0.9859              
                         F1             0.6819         0.9615              


                    DIABETES.a1c
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.04864 (0.22) 0.8065              
                         Recall         0.04864 (0.22) 0.3049              
                         F1             0.04864        0.4425              


                    DIABETES.glucose
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


                    OBESE.mention
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.155 (0.36)   0.8386              
                         Recall         0.1654 (0.37)  0.9755              
                         F1             0.16           0.9019              


                    OBESE.bmi
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


                    HYPERLIPIDEMIA.mention
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.43 (0.5)     0.9609              
                         Recall         0.43 (0.5)     0.9325              
                         F1             0.43           0.9465              


                    HYPERLIPIDEMIA.high_ldl
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.001946 (0.044)1.0                 
                         Recall         0.001946 (0.044)0.03448             
                         F1             0.001946       0.06667             


                    HYPERLIPIDEMIA.high_chol
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


                    HYPERTENSION.mention
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.7043 (0.45)  0.9577              
                         Recall         0.7082 (0.45)  0.9891              
                         F1             0.7062         0.9731              


                    HYPERTENSION.high_bp
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.2763 (0.45)  0.5182              
                         Recall         0.2665 (0.44)  0.7282              
                         F1             0.2713         0.6055              


                    MEDICATION.ace_inhibitor
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.3515 (0.47)  0.9033              
                         Recall         0.3696 (0.48)  0.8813              
                         F1             0.3603         0.8922              


                    MEDICATION.anti_diabetes
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


                    MEDICATION.arb
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.06809 (0.25) 0.8974              
                         Recall         0.07198 (0.26) 0.544               
                         F1             0.06998        0.6774              


                    MEDICATION.aspirin
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.513 (0.49)   0.9123              
                         Recall         0.5409 (0.5)   0.9912              
                         F1             0.5265         0.9502              


                    MEDICATION.beta_blocker
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.5227 (0.49)  0.8986              
                         Recall         0.5564 (0.5)   0.9653              
                         F1             0.539          0.9307              


                    MEDICATION.calcium_channel_blocker
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.227 (0.41)   0.9186              
                         Recall         0.2432 (0.43)  0.9091              
                         F1             0.2348         0.9138              


                    MEDICATION.diuretic
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1167 (0.31)  0.7895              
                         Recall         0.1289 (0.33)  0.7087              
                         F1             0.1225         0.7469              


                    MEDICATION.dpp4_inhibitors
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


                    MEDICATION.ezetimibe
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


                    MEDICATION.fibrate
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


                    MEDICATION.insulin
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.2477 (0.43)  0.8433              
                         Recall         0.2607 (0.44)  0.9671              
                         F1             0.254          0.9009              


                    MEDICATION.metformin
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.2231 (0.41)  0.8557              
                         Recall         0.2481 (0.43)  0.9272              
                         F1             0.2349         0.89                


                    MEDICATION.niacin
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


                    MEDICATION.nitrate
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1394 (0.33)  0.779               
                         Recall         0.1615 (0.37)  0.7934              
                         F1             0.1496         0.7861              


                    MEDICATION.statin
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.5058 (0.49)  0.9286              
                         Recall         0.5253 (0.5)   0.9547              
                         F1             0.5154         0.9415              


                    MEDICATION.sulfonylureas
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1608 (0.36)  0.9394              
                         Recall         0.1673 (0.37)  0.8611              
                         F1             0.164          0.8986              


                    MEDICATION.thiazolidinedione
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.01621 (0.12) 0.9259              
                         Recall         0.01751 (0.13) 0.4098              
                         F1             0.01684        0.5682              


                    MEDICATION.thienopyridine
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1777 (0.38)  0.9043              
                         Recall         0.1907 (0.39)  0.9648              
                         F1             0.1839         0.9336              


                    SMOKER.current
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


                    SMOKER.past
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1946 (0.4)   0.7353              
                         Recall         0.1946 (0.4)   0.885               
                         F1             0.1946         0.8032              


                    SMOKER.ever
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


                    SMOKER.never
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1537 (0.36)  0.8229              
                         Recall         0.1537 (0.36)  0.6583              
                         F1             0.1537         0.7315              


                    SMOKER.unknown
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.4689 (0.5)   0.8142              
                         Recall         0.4689 (0.5)   0.9918              
                         F1             0.4689         0.8942              


                    FAMILY_HIST.present
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


                    FAMILY_HIST.not_present
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.963 (0.19)   0.963               
                         Recall         0.963 (0.19)   1.0                 
                         F1             0.963          0.9812                     

MODEL

nb_words = 36664
max_length = 3390
embedding_dim = 20

model = Sequential()
model.add(Embedding(nb_words, embedding_dim, input_length=max_length, mask_zero=True, weights=[embedding_weights]))
model.add(SimpleRNN(256, return_sequences=True, dropout=0.3, recurrent_dropout=0.3))
model.add(TimeDistributed(Dense(encoded_Y.shape[2], activation='softmax')))

optimiser = Nadam(lr=0.002, beta_1=0.9, beta_2=0.999, epsilon=1e-08, schedule_decay=0.004)
model.compile(loss='categorical_crossentropy', optimizer=optimiser) 

model.fit(X_train, encoded_Y, epochs=40, batch_size=32, verbose=2)


                    OVERALL
--------------------------------------------------------------------------- 
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.8798 (0.14)  0.8831              
                         Recall         0.8846 (0.12)  0.8824              
                         F1             0.8822         0.8827              

                    CAD
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.3414 (0.46)  0.7798              
                         Recall         0.3247 (0.44)  0.8087              
                         F1             0.3328         0.794               

                    DIABETES
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.677 (0.46)   0.9334              
                         Recall         0.6499 (0.45)  0.9153              
                         F1             0.6632         0.9243              

                    OBESE
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.155 (0.36)   0.8386              
                         Recall         0.1586 (0.36)  0.9122              
                         F1             0.1568         0.8739              

                    HYPERLIPIDEMIA
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.4339 (0.5)   0.953               
                         Recall         0.4232 (0.49)  0.8908              
                         F1             0.4285         0.9209              

                    HYPERTENSION
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.6926 (0.41)  0.851               
                         Recall         0.7358 (0.42)  0.9582              
                         F1             0.7136         0.9014              

                    MEDICATION
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.7631 (0.35)  0.8927              
                         Recall         0.7579 (0.34)  0.8652              
                         F1             0.7605         0.8787              

                    SMOKER
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.7899 (0.4)   0.7743              
                         Recall         0.8074 (0.39)  0.8105              
                         F1             0.7985         0.792               

                    FAMILY_HIST
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.963 (0.19)   0.963               
                         Recall         0.963 (0.19)   0.963               
                         F1             0.963          0.963               

                    CAD.mention
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.3268 (0.47)  0.7925              
                         Recall         0.3327 (0.47)  0.9767              
                         F1             0.3297         0.875               

                    CAD.event
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1576 (0.36)  0.9                 
                         Recall         0.1566 (0.36)  0.5827              
                         F1             0.1571         0.7074              

                    CAD.test
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.09339 (0.29) 0.5581              
                         Recall         0.08949 (0.28) 0.8136              
                         F1             0.0914         0.6621              

                    CAD.symptom
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.001946 (0.044)1.0                 
                         Recall         0.001946 (0.044)0.01429             
                         F1             0.001946       0.02817             

                    DIABETES.mention
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.677 (0.47)   0.938               
                         Recall         0.679 (0.47)   0.9803              
                         F1             0.678          0.9587              

                    DIABETES.a1c
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.07004 (0.26) 0.8182              
                         Recall         0.06809 (0.25) 0.439               
                         F1             0.06905        0.5714              

                    DIABETES.glucose
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 

                    OBESE.mention
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.155 (0.36)   0.8386              
                         Recall         0.1654 (0.37)  0.9755              
                         F1             0.16           0.9019              

                    OBESE.bmi
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 

                    HYPERLIPIDEMIA.mention
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.4339 (0.5)   0.953               
                         Recall         0.4339 (0.5)   0.9409              
                         F1             0.4339         0.9469              

                    HYPERLIPIDEMIA.high_ldl
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 

                    HYPERLIPIDEMIA.high_chol
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 

                    HYPERTENSION.mention
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.7043 (0.45)  0.9577              
                         Recall         0.7082 (0.45)  0.9891              
                         F1             0.7062         0.9731              

                    HYPERTENSION.high_bp
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.2977 (0.46)  0.4752              
                         Recall         0.287 (0.45)   0.7846              
                         F1             0.2922         0.5919              

                    MEDICATION.ace_inhibitor
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.3651 (0.47)  0.8811              
                         Recall         0.3833 (0.49)  0.9154              
                         F1             0.374          0.8979              

                    MEDICATION.anti_diabetes
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 

                    MEDICATION.arb
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 

                    MEDICATION.aspirin
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.513 (0.49)   0.9123              
                         Recall         0.5409 (0.5)   0.9912              
                         F1             0.5265         0.9502              

                    MEDICATION.beta_blocker
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.5071 (0.49)  0.8958              
                         Recall         0.537 (0.5)    0.9365              
                         F1             0.5216         0.9157              

                    MEDICATION.calcium_channel_blocker
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.2043 (0.4)   0.9375              
                         Recall         0.214 (0.41)   0.8182              
                         F1             0.209          0.8738              

                    MEDICATION.diuretic
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1115 (0.31)  0.7854              
                         Recall         0.1211 (0.33)  0.6772              
                         F1             0.1161         0.7273              

                    MEDICATION.dpp4_inhibitors
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 

                    MEDICATION.ezetimibe
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 

                    MEDICATION.fibrate
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 

                    MEDICATION.insulin
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.2497 (0.43)  0.8443              
                         Recall         0.2626 (0.44)  0.9747              
                         F1             0.256          0.9048              

                    MEDICATION.metformin
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.2309 (0.41)  0.8537              
                         Recall         0.2558 (0.44)  0.9596              
                         F1             0.2427         0.9036              

                   MEDICATION.niacin
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 

                    MEDICATION.nitrate
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.12 (0.32)    0.881               
                         Recall         0.1284 (0.33)  0.6827              
                         F1             0.124          0.7692              

                    MEDICATION.statin
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.5097 (0.49)  0.9258              
                         Recall         0.5292 (0.5)   0.9621              
                         F1             0.5193         0.9436              

                    MEDICATION.sulfonylureas
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1647 (0.37)  0.9304              
                         Recall         0.1712 (0.38)  0.8819              
                         F1             0.1679         0.9055              

                    MEDICATION.thiazolidinedione
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.02918 (0.16) 0.8333              
                         Recall         0.03307 (0.18) 0.7377              
                         F1             0.03101        0.7826              

                    MEDICATION.thienopyridine
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1783 (0.38)  0.8987              
                         Recall         0.1926 (0.39)  0.9683              
                         F1             0.1852         0.9322              

                    SMOKER.current
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 

                    SMOKER.past
---------------------------------------------------------------------------
           (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1809 (0.38)  0.744               
                         Recall         0.1809 (0.38)  0.823               
                         F1             0.1809         0.7815              

                    SMOKER.ever
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 

                    SMOKER.never
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1615 (0.37)  0.7411              
                         Recall         0.1615 (0.37)  0.6917              
                         F1             0.1615         0.7155              

                    SMOKER.unknown
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.465 (0.5)    0.7993              
                         Recall         0.465 (0.5)    0.9835              
                         F1             0.465          0.8819              

                    FAMILY_HIST.present
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 

                    FAMILY_HIST.not_present
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.963 (0.19)   0.963               
                         Recall         0.963 (0.19)   1.0                 
                         F1             0.963          0.9812              

