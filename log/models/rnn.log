MODEL

nb_words = 36664
max_length = 3390
embedding_dim = 20

model = Sequential()
model.add(Embedding(nb_words, embedding_dim, input_length=max_length, mask_zero=True, weights=[embedding_weights]))
model.add(SimpleRNN(256, return_sequences=True, dropout=0.1, recurrent_dropout=0.2))
model.add(TimeDistributed(Dense(encoded_Y.shape[2], activation='softmax')))

optimiser = Nadam(lr=0.002, beta_1=0.9, beta_2=0.999, epsilon=1e-08, schedule_decay=0.004)
model.compile(loss='categorical_crossentropy', optimizer=optimiser) 

model.fit(X_train, encoded_Y, epochs=30, batch_size=32, verbose=2)

				OVERALL
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.8813 (0.13)  0.885               
                         Recall         0.8875 (0.12)  0.8854              
                         F1             0.8844         0.8852              


				CAD
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.3443 (0.46)  0.764               
                         Recall         0.3426 (0.45)  0.838               
                         F1             0.3434         0.7993              


				DIABETES
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.679 (0.46)   0.9334              
                         Recall         0.6568 (0.45)  0.9271              
                         F1             0.6677         0.9303              


				OBESE
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1511 (0.36)  0.863               
                         Recall         0.1508 (0.35)  0.8893              
                         F1             0.1509         0.8759              


				HYPERLIPIDEMIA
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.4339 (0.5)   0.953               
                         Recall         0.4232 (0.49)  0.8908              
                         F1             0.4285         0.9209              


				HYPERTENSION
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.6975 (0.42)  0.8673              
                         Recall         0.731 (0.43)   0.9551              
                         F1             0.7138         0.9091              


				MEDICATION
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.7553 (0.36)  0.8928              
                         Recall         0.7564 (0.34)  0.8657              
                         F1             0.7558         0.879               


				SMOKER
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.7977 (0.39)  0.7872              
                         Recall         0.8132 (0.39)  0.8164              
                         F1             0.8054         0.8015              


				FAMILY_HIST
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.963 (0.19)   0.963               
                         Recall         0.963 (0.19)   0.963               
                         F1             0.963          0.963               


				CAD.mention
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.3268 (0.47)  0.7814              
                         Recall         0.3327 (0.47)  0.9767              
                         F1             0.3297         0.8682              


				CAD.event
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.2198 (0.41)  0.7386              
                         Recall         0.2179 (0.41)  0.8129              
                         F1             0.2189         0.774               


				CAD.test
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.07393 (0.26) 0.6441              
                         Recall         0.07004 (0.25) 0.6441              
                         F1             0.07193        0.6441              


				CAD.symptom
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.003891 (0.062)0.6667              
                         Recall         0.003891 (0.062)0.02857             
                         F1             0.003891       0.05479             


				DIABETES.mention
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.6829 (0.46)  0.941               
                         Recall         0.6848 (0.46)  0.9887              
                         F1             0.6839         0.9643              


				DIABETES.a1c
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.07977 (0.27) 0.7736              
                         Recall         0.07782 (0.27) 0.5                 
                         F1             0.07878        0.6074              


				DIABETES.glucose
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


				OBESE.mention
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1511 (0.36)  0.863               
                         Recall         0.1576 (0.36)  0.951               
                         F1             0.1543         0.9049              


				OBESE.bmi
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


				HYPERLIPIDEMIA.mention
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.4339 (0.5)   0.953               
                         Recall         0.4339 (0.5)   0.9409              
                         F1             0.4339         0.9469              


				HYPERLIPIDEMIA.high_ldl
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


				HYPERLIPIDEMIA.high_chol
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


				HYPERTENSION.mention
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.7043 (0.45)  0.9577              
                         Recall         0.7082 (0.45)  0.9891              
                         F1             0.7062         0.9731              


				HYPERTENSION.high_bp
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.2899 (0.45)  0.5138              
                         Recall         0.2792 (0.44)  0.7641              
                         F1             0.2844         0.6144              


				MEDICATION.ace_inhibitor
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.3547 (0.47)  0.8851              
                         Recall         0.3716 (0.48)  0.8894              
                         F1             0.363          0.8873              


				MEDICATION.anti_diabetes
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


				MEDICATION.arb
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.008431 (0.089)0.8667              
                         Recall         0.009728 (0.098)0.06736             
                         F1             0.009033       0.125               


				MEDICATION.aspirin
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.513 (0.49)   0.9092              
                         Recall         0.5409 (0.5)   0.9912              
                         F1             0.5265         0.9484              


				MEDICATION.beta_blocker
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.5182 (0.49)  0.8937              
                         Recall         0.5506 (0.5)   0.9569              
                         F1             0.5339         0.9242              


				MEDICATION.calcium_channel_blocker
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.2205 (0.41)  0.9366              
                         Recall         0.2315 (0.42)  0.8831              
                         F1             0.2259         0.9091              


				MEDICATION.diuretic
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.09792 (0.29) 0.8251              
                         Recall         0.1075 (0.31)  0.5945              
                         F1             0.1025         0.6911              


				MEDICATION.dpp4_inhibitors
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


				MEDICATION.ezetimibe
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


				MEDICATION.fibrate
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


				MEDICATION.insulin
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.2497 (0.43)  0.8556              
                         Recall         0.2626 (0.44)  0.9747              
                         F1             0.256          0.9112              


				MEDICATION.metformin
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.2309 (0.41)  0.8599              
                         Recall         0.2558 (0.44)  0.9596              
                         F1             0.2427         0.907               


				MEDICATION.niacin
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


				MEDICATION.nitrate
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1505 (0.35)  0.7657              
                         Recall         0.1712 (0.38)  0.8561              
                         F1             0.1602         0.8084              


				MEDICATION.statin
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.489 (0.49)   0.9449              
                         Recall         0.5058 (0.5)   0.9229              
                         F1             0.4973         0.9337              


				MEDICATION.sulfonylureas
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1608 (0.36)  0.9394              
                         Recall         0.1673 (0.37)  0.8611              
                         F1             0.164          0.8986              


				MEDICATION.thiazolidinedione
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.01621 (0.12) 0.8333              
                         Recall         0.01751 (0.13) 0.4098              
                         F1             0.01684        0.5495              


				MEDICATION.thienopyridine
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1757 (0.37)  0.9033              
                         Recall         0.1887 (0.39)  0.9542              
                         F1             0.182          0.9281              


				SMOKER.current
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


				SMOKER.past
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.2043 (0.4)   0.6562              
                         Recall         0.2043 (0.4)   0.9292              
                         F1             0.2043         0.7692              


				SMOKER.ever
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


				SMOKER.never
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1459 (0.35)  0.8721              
                         Recall         0.1459 (0.35)  0.625               
                         F1             0.1459         0.7282              


				SMOKER.unknown
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.463 (0.5)    0.8351              
                         Recall         0.463 (0.5)    0.9794              
                         F1             0.463          0.9015              


				FAMILY_HIST.present
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


				FAMILY_HIST.not_present
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.963 (0.19)   0.963               
                         Recall         0.963 (0.19)   1.0                 
                         F1             0.963          0.9812              
