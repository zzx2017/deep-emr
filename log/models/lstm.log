MODEL

nb_words = 36664
max_length = 3390
embedding_dim = 20

model = Sequential()
model.add(Embedding(nb_words, embedding_dim, input_length=max_length, mask_zero=True, weights=[embedding_weights]))
model.add(LSTM(512, return_sequences=True, dropout=0.2, recurrent_dropout=0.2))
model.add(TimeDistributed(Dense(encoded_Y.shape[2], activation='softmax')))

optimiser = Nadam(lr=0.002, beta_1=0.9, beta_2=0.999, epsilon=1e-08, schedule_decay=0.004)
model.compile(loss='categorical_crossentropy', optimizer=optimiser) 

model.fit(X_train, encoded_Y, epochs=40, batch_size=32, verbose=2)

				OVERALL
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.8786 (0.13)  0.8843              
                         Recall         0.912 (0.11)   0.9103              
                         F1             0.895          0.8971              


				CAD
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.3469 (0.45)  0.7849              
                         Recall         0.3465 (0.45)  0.8329              
                         F1             0.3467         0.8082              


				DIABETES
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.6756 (0.46)  0.9253              
                         Recall         0.6548 (0.45)  0.9237              
                         F1             0.665          0.9245              


				OBESE
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1479 (0.35)  0.8745              
                         Recall         0.1458 (0.35)  0.8779              
                         F1             0.1468         0.8762              


				HYPERLIPIDEMIA
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.4246 (0.49)  0.9579              
                         Recall         0.4174 (0.49)  0.8788              
                         F1             0.421          0.9167              


				HYPERTENSION
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.6908 (0.42)  0.8814              
                         Recall         0.7093 (0.43)  0.9312              
                         F1             0.6999         0.9056              


				MEDICATION
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.7592 (0.34)  0.8862              
                         Recall         0.807 (0.34)   0.9207              
                         F1             0.7824         0.9031              


				SMOKER
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.8113 (0.37)  0.7856              
                         Recall         0.8482 (0.36)  0.8516              
                         F1             0.8294         0.8172              


				FAMILY_HIST
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.9514 (0.22)  0.9514              
                         Recall         0.9514 (0.22)  0.9514              
                         F1             0.9514         0.9514              


				CAD.mention
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.3204 (0.46)  0.8401              
                         Recall         0.3249 (0.47)  0.9574              
                         F1             0.3226         0.8949              


				CAD.event
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.214 (0.41)   0.719               
                         Recall         0.2111 (0.41)  0.7914              
                         F1             0.2125         0.7534              


				CAD.test
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0642 (0.25)  0.6364              
                         Recall         0.06323 (0.24) 0.5932              
                         F1             0.06371        0.614               


				CAD.symptom
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.02237 (0.14) 0.3889              
                         Recall         0.02335 (0.15) 0.2                 
                         F1             0.02285        0.2642              


				DIABETES.mention
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.679 (0.47)   0.9332              
                         Recall         0.6809 (0.47)  0.9831              
                         F1             0.68           0.9575              


				DIABETES.a1c
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.08366 (0.28) 0.7679              
                         Recall         0.08171 (0.27) 0.5244              
                         F1             0.08267        0.6232              


				DIABETES.glucose
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


				OBESE.mention
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1479 (0.35)  0.8837              
                         Recall         0.1518 (0.36)  0.9306              
                         F1             0.1498         0.9066              


				OBESE.bmi
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.003891 (0.062)0.4                 
                         Recall         0.002594 (0.046)0.1176              
                         F1             0.003113       0.1818              


				HYPERLIPIDEMIA.mention
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.4261 (0.49)  0.9648              
                         Recall         0.4261 (0.49)  0.9241              
                         F1             0.4261         0.944               


				HYPERLIPIDEMIA.high_ldl
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.005837 (0.076)0.375               
                         Recall         0.005837 (0.076)0.1034              
                         F1             0.005837       0.1622              


				HYPERLIPIDEMIA.high_chol
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


				HYPERTENSION.mention
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.7004 (0.46)  0.9704              
                         Recall         0.7043 (0.46)  0.9836              
                         F1             0.7023         0.9769              


				HYPERTENSION.high_bp
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.2403 (0.43)  0.4901              
                         Recall         0.2325 (0.42)  0.6359              
                         F1             0.2363         0.5536              


				MEDICATION.ace_inhibitor
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.3684 (0.48)  0.8645              
                         Recall         0.3852 (0.49)  0.9236              
                         F1             0.3766         0.8931              


				MEDICATION.anti_diabetes
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


				MEDICATION.arb
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.09144 (0.29) 0.9216              
                         Recall         0.09533 (0.29) 0.7306              
                         F1             0.09334        0.815               


				MEDICATION.aspirin
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.5123 (0.49)  0.9207              
                         Recall         0.5389 (0.5)   0.99                
                         F1             0.5253         0.9541              


				MEDICATION.beta_blocker
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.5149 (0.49)  0.9002              
                         Recall         0.5447 (0.5)   0.9509              
                         F1             0.5294         0.9249              


				MEDICATION.calcium_channel_blocker
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.2348 (0.42)  0.9073              
                         Recall         0.251 (0.43)   0.9403              
                         F1             0.2426         0.9235              


				MEDICATION.diuretic
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1154 (0.31)  0.8018              
                         Recall         0.1279 (0.33)  0.7008              
                         F1             0.1214         0.7479              


				MEDICATION.dpp4_inhibitors
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


				MEDICATION.ezetimibe
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


				MEDICATION.fibrate
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.01946 (0.14) 1.0                 
                         Recall         0.01946 (0.14) 0.3333              
                         F1             0.01946        0.5                 


				MEDICATION.insulin
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.2516 (0.43)  0.8398              
                         Recall         0.2646 (0.44)  0.9823              
                         F1             0.2579         0.9055              


				MEDICATION.metformin
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.2309 (0.41)  0.853               
                         Recall         0.2545 (0.43)  0.9542              
                         F1             0.2421         0.9008              


				MEDICATION.niacin
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


				MEDICATION.nitrate
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1608 (0.36)  0.7918              
                         Recall         0.1751 (0.38)  0.8561              
                         F1             0.1677         0.8227              


				MEDICATION.statin
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.513 (0.49)   0.9284              
                         Recall         0.5311 (0.5)   0.9682              
                         F1             0.5219         0.9479              


				MEDICATION.sulfonylureas
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1706 (0.37)  0.8946              
                         Recall         0.177 (0.38)   0.9132              
                         F1             0.1737         0.9038              


				MEDICATION.thiazolidinedione
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.03761 (0.19) 0.8056              
                         Recall         0.0428 (0.2)   0.9508              
                         F1             0.04004        0.8722              


				MEDICATION.thienopyridine
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1783 (0.38)  0.8987              
                         Recall         0.1926 (0.39)  0.9683              
                         F1             0.1852         0.9322              


				SMOKER.current
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.02335 (0.15) 0.5217              
                         Recall         0.02335 (0.15) 0.3636              
                         F1             0.02335        0.4286              


				SMOKER.past
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1965 (0.4)   0.6733              
                         Recall         0.1965 (0.4)   0.8938              
                         F1             0.1965         0.7681              


				SMOKER.ever
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


				SMOKER.never
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1693 (0.37)  0.8056              
                         Recall         0.1693 (0.37)  0.725               
                         F1             0.1693         0.7632              


				SMOKER.unknown
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.4591 (0.5)   0.8613              
                         Recall         0.4591 (0.5)   0.9712              
                         F1             0.4591         0.913               


				FAMILY_HIST.present
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.005837 (0.076)0.25                
                         Recall         0.005837 (0.076)0.1579              
                         F1             0.005837       0.1935              


				FAMILY_HIST.not_present
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.9455 (0.23)  0.9681              
                         Recall         0.9455 (0.23)  0.9818              
                         F1             0.9455         0.9749              
