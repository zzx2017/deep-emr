MODEL

nb_words = 36664
max_length = 3390
embedding_dim = 20

model = Sequential()
model.add(Embedding(nb_words, embedding_dim, input_length=max_length, mask_zero=True, weights=[embedding_weights]))
model.add(LSTM(512, return_sequences=True, dropout=0.2, recurrent_dropout=0.2))
model.add(TimeDistributed(Dense(encoded_Y.shape[2], activation='softmax')))

optimiser = Nadam(lr=0.002, beta_1=0.9, beta_2=0.999, epsilon=1e-08, schedule_decay=0.004)
model.compile(loss='categorical_crossentropy', optimizer=optimiser) 

model.fit(X_train, encoded_Y, epochs=40, batch_size=32, verbose=2)

				OVERALL
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.8786 (0.13)  0.8843              
                         Recall         0.912 (0.11)   0.9103              
                         F1             0.895          0.8971              


				CAD
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.3469 (0.45)  0.7849              
                         Recall         0.3465 (0.45)  0.8329              
                         F1             0.3467         0.8082              


				DIABETES
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.6756 (0.46)  0.9253              
                         Recall         0.6548 (0.45)  0.9237              
                         F1             0.665          0.9245              


				OBESE
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1479 (0.35)  0.8745              
                         Recall         0.1458 (0.35)  0.8779              
                         F1             0.1468         0.8762              


				HYPERLIPIDEMIA
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.4246 (0.49)  0.9579              
                         Recall         0.4174 (0.49)  0.8788              
                         F1             0.421          0.9167              


				HYPERTENSION
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.6908 (0.42)  0.8814              
                         Recall         0.7093 (0.43)  0.9312              
                         F1             0.6999         0.9056              


				MEDICATION
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.7592 (0.34)  0.8862              
                         Recall         0.807 (0.34)   0.9207              
                         F1             0.7824         0.9031              


				SMOKER
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.8113 (0.37)  0.7856              
                         Recall         0.8482 (0.36)  0.8516              
                         F1             0.8294         0.8172              


				FAMILY_HIST
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.9514 (0.22)  0.9514              
                         Recall         0.9514 (0.22)  0.9514              
                         F1             0.9514         0.9514              


				CAD.mention
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.3204 (0.46)  0.8401              
                         Recall         0.3249 (0.47)  0.9574              
                         F1             0.3226         0.8949              


				CAD.event
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.214 (0.41)   0.719               
                         Recall         0.2111 (0.41)  0.7914              
                         F1             0.2125         0.7534              


				CAD.test
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0642 (0.25)  0.6364              
                         Recall         0.06323 (0.24) 0.5932              
                         F1             0.06371        0.614               


				CAD.symptom
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.02237 (0.14) 0.3889              
                         Recall         0.02335 (0.15) 0.2                 
                         F1             0.02285        0.2642              


				DIABETES.mention
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.679 (0.47)   0.9332              
                         Recall         0.6809 (0.47)  0.9831              
                         F1             0.68           0.9575              


				DIABETES.a1c
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.08366 (0.28) 0.7679              
                         Recall         0.08171 (0.27) 0.5244              
                         F1             0.08267        0.6232              


				DIABETES.glucose
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


				OBESE.mention
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1479 (0.35)  0.8837              
                         Recall         0.1518 (0.36)  0.9306              
                         F1             0.1498         0.9066              


				OBESE.bmi
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.003891 (0.062)0.4                 
                         Recall         0.002594 (0.046)0.1176              
                         F1             0.003113       0.1818              


				HYPERLIPIDEMIA.mention
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.4261 (0.49)  0.9648              
                         Recall         0.4261 (0.49)  0.9241              
                         F1             0.4261         0.944               


				HYPERLIPIDEMIA.high_ldl
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.005837 (0.076)0.375               
                         Recall         0.005837 (0.076)0.1034              
                         F1             0.005837       0.1622              


				HYPERLIPIDEMIA.high_chol
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


				HYPERTENSION.mention
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.7004 (0.46)  0.9704              
                         Recall         0.7043 (0.46)  0.9836              
                         F1             0.7023         0.9769              


				HYPERTENSION.high_bp
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.2403 (0.43)  0.4901              
                         Recall         0.2325 (0.42)  0.6359              
                         F1             0.2363         0.5536              


				MEDICATION.ace_inhibitor
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.3684 (0.48)  0.8645              
                         Recall         0.3852 (0.49)  0.9236              
                         F1             0.3766         0.8931              


				MEDICATION.anti_diabetes
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


				MEDICATION.arb
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.09144 (0.29) 0.9216              
                         Recall         0.09533 (0.29) 0.7306              
                         F1             0.09334        0.815               


				MEDICATION.aspirin
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.5123 (0.49)  0.9207              
                         Recall         0.5389 (0.5)   0.99                
                         F1             0.5253         0.9541              


				MEDICATION.beta_blocker
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.5149 (0.49)  0.9002              
                         Recall         0.5447 (0.5)   0.9509              
                         F1             0.5294         0.9249              


				MEDICATION.calcium_channel_blocker
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.2348 (0.42)  0.9073              
                         Recall         0.251 (0.43)   0.9403              
                         F1             0.2426         0.9235              


				MEDICATION.diuretic
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1154 (0.31)  0.8018              
                         Recall         0.1279 (0.33)  0.7008              
                         F1             0.1214         0.7479              


				MEDICATION.dpp4_inhibitors
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


				MEDICATION.ezetimibe
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


				MEDICATION.fibrate
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.01946 (0.14) 1.0                 
                         Recall         0.01946 (0.14) 0.3333              
                         F1             0.01946        0.5                 


				MEDICATION.insulin
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.2516 (0.43)  0.8398              
                         Recall         0.2646 (0.44)  0.9823              
                         F1             0.2579         0.9055              


				MEDICATION.metformin
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.2309 (0.41)  0.853               
                         Recall         0.2545 (0.43)  0.9542              
                         F1             0.2421         0.9008              


				MEDICATION.niacin
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


				MEDICATION.nitrate
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1608 (0.36)  0.7918              
                         Recall         0.1751 (0.38)  0.8561              
                         F1             0.1677         0.8227              


				MEDICATION.statin
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.513 (0.49)   0.9284              
                         Recall         0.5311 (0.5)   0.9682              
                         F1             0.5219         0.9479              


				MEDICATION.sulfonylureas
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1706 (0.37)  0.8946              
                         Recall         0.177 (0.38)   0.9132              
                         F1             0.1737         0.9038              


				MEDICATION.thiazolidinedione
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.03761 (0.19) 0.8056              
                         Recall         0.0428 (0.2)   0.9508              
                         F1             0.04004        0.8722              


				MEDICATION.thienopyridine
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1783 (0.38)  0.8987              
                         Recall         0.1926 (0.39)  0.9683              
                         F1             0.1852         0.9322              


				SMOKER.current
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.02335 (0.15) 0.5217              
                         Recall         0.02335 (0.15) 0.3636              
                         F1             0.02335        0.4286              


				SMOKER.past
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1965 (0.4)   0.6733              
                         Recall         0.1965 (0.4)   0.8938              
                         F1             0.1965         0.7681              


				SMOKER.ever
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


				SMOKER.never
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1693 (0.37)  0.8056              
                         Recall         0.1693 (0.37)  0.725               
                         F1             0.1693         0.7632              


				SMOKER.unknown
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.4591 (0.5)   0.8613              
                         Recall         0.4591 (0.5)   0.9712              
                         F1             0.4591         0.913               


				FAMILY_HIST.present
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.005837 (0.076)0.25                
                         Recall         0.005837 (0.076)0.1579              
                         F1             0.005837       0.1935              


				FAMILY_HIST.not_present
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.9455 (0.23)  0.9681              
                         Recall         0.9455 (0.23)  0.9818              
                         F1             0.9455         0.9749              

MODEL

nb_words = 36664
max_length = 3390
embedding_dim = 20

model = Sequential()
model.add(Embedding(nb_words, embedding_dim, input_length=max_length, mask_zero=True, weights=[embedding_weights]))
model.add(LSTM(512, return_sequences=True, dropout=0.2, recurrent_dropout=0.2))
model.add(TimeDistributed(Dense(encoded_Y.shape[2], activation='softmax')))

optimiser = Nadam(lr=0.002, beta_1=0.9, beta_2=0.999, epsilon=1e-08, schedule_decay=0.004)
model.compile(loss='categorical_crossentropy', optimizer=optimiser) 

model.fit(X_train, encoded_Y, epochs=40, batch_size=32, verbose=2)

                    OVERALL
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.8814 (0.13)  0.8863              
                         Recall         0.9147 (0.1)   0.9153              
                         F1             0.8977         0.9006              


                    CAD
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.3455 (0.45)  0.7551              
                         Recall         0.3462 (0.45)  0.8418              
                         F1             0.3458         0.7961              


                    DIABETES
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.677 (0.46)   0.9353              
                         Recall         0.6521 (0.45)  0.9195              
                         F1             0.6644         0.9274              


                    OBESE
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1518 (0.36)  0.9038              
                         Recall         0.1492 (0.35)  0.8969              
                         F1             0.1504         0.9004              


                    HYPERLIPIDEMIA
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.4241 (0.49)  0.9592              
                         Recall         0.416 (0.49)   0.8762              
                         F1             0.42           0.9158              


                    HYPERTENSION
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.6985 (0.42)  0.8741              
                         Recall         0.7315 (0.43)  0.9559              
                         F1             0.7146         0.9132              


                    MEDICATION
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.7666 (0.35)  0.8942              
                         Recall         0.8025 (0.34)  0.9217              
                         F1             0.7841         0.9077              


                    SMOKER
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.81 (0.36)    0.7745              
                         Recall         0.8619 (0.35)  0.8652              
                         F1             0.8351         0.8173              


                    FAMILY_HIST
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.9611 (0.19)  0.9611              
                         Recall         0.9611 (0.19)  0.9611              
                         F1             0.9611         0.9611              


                    CAD.mention
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.3262 (0.47)  0.81                
                         Recall         0.3307 (0.47)  0.9748              
                         F1             0.3285         0.8848              


                    CAD.event
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1965 (0.4)   0.7133              
                         Recall         0.1965 (0.4)   0.7338              
                         F1             0.1965         0.7234              


                    CAD.test
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.07588 (0.26) 0.6                 
                         Recall         0.07198 (0.25) 0.661               
                         F1             0.07388        0.629               


                    CAD.symptom
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.03113 (0.17) 0.3556              
                         Recall         0.02789 (0.16) 0.2286              
                         F1             0.02942        0.2783              


                    DIABETES.mention
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.6809 (0.47)  0.9459              
                         Recall         0.6829 (0.47)  0.9859              
                         F1             0.6819         0.9655              


                    DIABETES.a1c
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.06809 (0.25) 0.7143              
                         Recall         0.06809 (0.25) 0.4268              
                         F1             0.06809        0.5344              


                    DIABETES.glucose
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


                    OBESE.mention
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1518 (0.36)  0.9176              
                         Recall         0.1556 (0.36)  0.9551              
                         F1             0.1537         0.936               


                    OBESE.bmi
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.001946 (0.044)0.2                 
                         Recall         0.0006485 (0.015)0.05882             
                         F1             0.0009728      0.09091             


                    HYPERLIPIDEMIA.mention
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.4261 (0.49)  0.9648              
                         Recall         0.4261 (0.49)  0.9241              
                         F1             0.4261         0.944               


                    HYPERLIPIDEMIA.high_ldl
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.001946 (0.044)0.2                 
                         Recall         0.001946 (0.044)0.03448             
                         F1             0.001946       0.05882             


                    HYPERLIPIDEMIA.high_chol
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


                    HYPERTENSION.mention
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.7023 (0.46)  0.9757              
                         Recall         0.7062 (0.46)  0.9863              
                         F1             0.7043         0.981               


                    HYPERTENSION.high_bp
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.2938 (0.45)  0.5033              
                         Recall         0.286 (0.45)   0.7846              
                         F1             0.2898         0.6132              


                    MEDICATION.ace_inhibitor
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.3573 (0.47)  0.8959              
                         Recall         0.3755 (0.48)  0.8959              
                         F1             0.3662         0.8959              


                    MEDICATION.anti_diabetes
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


                    MEDICATION.arb
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.09728 (0.29) 0.9259              
                         Recall         0.1012 (0.3)   0.7772              
                         F1             0.09918        0.8451              


                    MEDICATION.aspirin
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.5052 (0.49)  0.9373              
                         Recall         0.5224 (0.5)   0.9737              
                         F1             0.5136         0.9551              


                    MEDICATION.beta_blocker
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.5182 (0.49)  0.9026              
                         Recall         0.5506 (0.5)   0.9545              
                         F1             0.5339         0.9278              


                    MEDICATION.calcium_channel_blocker
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.2367 (0.42)  0.908               
                         Recall         0.2529 (0.43)  0.9481              
                         F1             0.2445         0.9276              


                    MEDICATION.diuretic
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1329 (0.33)  0.832               
                         Recall         0.1441 (0.35)  0.7992              
                         F1             0.1383         0.8153              


                    MEDICATION.dpp4_inhibitors
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


                    MEDICATION.ezetimibe
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


                    MEDICATION.fibrate
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.02724 (0.16) 1.0                 
                         Recall         0.02724 (0.16) 0.4667              
                         F1             0.02724        0.6364              


                    MEDICATION.insulin
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.2497 (0.43)  0.828               
                         Recall         0.2626 (0.44)  0.9747              
                         F1             0.256          0.8953              


                    MEDICATION.metformin
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.2263 (0.41)  0.8554              
                         Recall         0.25 (0.43)    0.9407              
                         F1             0.2376         0.896               


                    MEDICATION.niacin
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


                    MEDICATION.nitrate
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1621 (0.36)  0.7931              
                         Recall         0.1722 (0.38)  0.8487              
                         F1             0.167          0.82                


                    MEDICATION.statin
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.513 (0.49)   0.935               
                         Recall         0.5311 (0.5)   0.9682              
                         F1             0.5219         0.9513              


                    MEDICATION.sulfonylureas
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1686 (0.37)  0.8935              
                         Recall         0.1751 (0.38)  0.9028              
                         F1             0.1718         0.8981              


                    MEDICATION.thiazolidinedione
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.03567 (0.18) 0.8333              
                         Recall         0.04086 (0.2)  0.9016              
                         F1             0.03809        0.8661              


                    MEDICATION.thienopyridine
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1783 (0.38)  0.8987              
                         Recall         0.1926 (0.39)  0.9683              
                         F1             0.1852         0.9322              


                    SMOKER.current
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.02529 (0.16) 0.4815              
                         Recall         0.02529 (0.16) 0.3939              
                         F1             0.02529        0.4333              


                    SMOKER.past
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1809 (0.38)  0.75                
                         Recall         0.1809 (0.38)  0.823               
                         F1             0.1809         0.7848              


                    SMOKER.ever
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


                    SMOKER.never
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1965 (0.4)   0.6689              
                         Recall         0.1965 (0.4)   0.8417              
                         F1             0.1965         0.7454              


                    SMOKER.unknown
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.4591 (0.5)   0.8741              
                         Recall         0.4591 (0.5)   0.9712              
                         F1             0.4591         0.9201              


                    FAMILY_HIST.present
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.007782 (0.088)0.4444              
                         Recall         0.007782 (0.088)0.2105              
                         F1             0.007782       0.2857              


                    FAMILY_HIST.not_present
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.9533 (0.21)  0.9703              
                         Recall         0.9533 (0.21)  0.9899              
                         F1             0.9533         0.98     

MODEL

nb_words = 36664
max_length = 3390
embedding_dim = 20

model = Sequential()
model.add(Embedding(nb_words, embedding_dim, input_length=max_length, mask_zero=True, weights=[embedding_weights]))
model.add(LSTM(512, return_sequences=True, dropout=0.3, recurrent_dropout=0.3))
model.add(TimeDistributed(Dense(encoded_Y.shape[2], activation='softmax')))

optimiser = Nadam(lr=0.002, beta_1=0.9, beta_2=0.999, epsilon=1e-08, schedule_decay=0.004)
model.compile(loss='categorical_crossentropy', optimizer=optimiser) 

model.fit(X_train, encoded_Y, epochs=45, batch_size=32, verbose=2)

                    OVERALL
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.8686 (0.13)  0.873               
                         Recall         0.9271 (0.098) 0.9284              
                         F1             0.8969         0.8998              


                    CAD
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.3433 (0.44)  0.7426              
                         Recall         0.3571 (0.46)  0.861               
                         F1             0.35           0.7974              


                    DIABETES
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.6742 (0.45)  0.9144              
                         Recall         0.6683 (0.45)  0.9415              
                         F1             0.6712         0.9278              


                    OBESE
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1518 (0.36)  0.9015              
                         Recall         0.1506 (0.35)  0.9084              
                         F1             0.1512         0.9049              


                    HYPERLIPIDEMIA
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.4334 (0.49)  0.9534              
                         Recall         0.4259 (0.49)  0.8988              
                         F1             0.4296         0.9253              


                    HYPERTENSION
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.6851 (0.41)  0.8393              
                         Recall         0.7382 (0.42)  0.9613              
                         F1             0.7106         0.8962              


                    MEDICATION
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.7576 (0.34)  0.884               
                         Recall         0.8182 (0.34)  0.9358              
                         F1             0.7867         0.9092              


                    SMOKER
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.8113 (0.36)  0.7799              
                         Recall         0.8619 (0.35)  0.8652              
                         F1             0.8358         0.8204              


                    FAMILY_HIST
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.9514 (0.22)  0.9514              
                         Recall         0.9514 (0.22)  0.9514              
                         F1             0.9514         0.9514              


                    CAD.mention
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.3249 (0.47)  0.8146              
                         Recall         0.3307 (0.47)  0.9709              
                         F1             0.3278         0.8859              


                    CAD.event
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.2101 (0.41)  0.6875              
                         Recall         0.2111 (0.41)  0.7914              
                         F1             0.2106         0.7358              


                    CAD.test
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.08171 (0.27) 0.5244              
                         Recall         0.07879 (0.27) 0.7288              
                         F1             0.08023        0.6099              


                    CAD.symptom
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.03988 (0.19) 0.4038              
                         Recall         0.03664 (0.18) 0.3                 
                         F1             0.03819        0.3443              


                    DIABETES.mention
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.6848 (0.46)  0.9387              
                         Recall         0.6868 (0.46)  0.9915              
                         F1             0.6858         0.9644              


                    DIABETES.a1c
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1051 (0.31)  0.6353              
                         Recall         0.1021 (0.3)   0.6585              
                         F1             0.1036         0.6467              


                    DIABETES.glucose
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.001946 (0.044)0.2                 
                         Recall         0.001946 (0.044)0.0303              
                         F1             0.001946       0.05263             


                    OBESE.mention
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1518 (0.36)  0.9176              
                         Recall         0.1556 (0.36)  0.9551              
                         F1             0.1537         0.936               


                    OBESE.bmi
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.007782 (0.088)0.4444              
                         Recall         0.006485 (0.078)0.2353              
                         F1             0.007075       0.3077              


                    HYPERLIPIDEMIA.mention
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.4358 (0.5)   0.9614              
                         Recall         0.4358 (0.5)   0.9451              
                         F1             0.4358         0.9532              


                    HYPERLIPIDEMIA.high_ldl
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.005837 (0.076)0.3333              
                         Recall         0.005837 (0.076)0.1034              
                         F1             0.005837       0.1579              


                    HYPERLIPIDEMIA.high_chol
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


                    HYPERTENSION.mention
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.7043 (0.45)  0.9602              
                         Recall         0.7082 (0.45)  0.9891              
                         F1             0.7062         0.9744              


                    HYPERTENSION.high_bp
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.2996 (0.46)  0.4486              
                         Recall         0.2928 (0.45)  0.8051              
                         F1             0.2962         0.5761              


                    MEDICATION.ace_inhibitor
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.3671 (0.47)  0.8615              
                         Recall         0.3852 (0.49)  0.9203              
                         F1             0.3759         0.8899              


                    MEDICATION.anti_diabetes
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


                    MEDICATION.arb
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1005 (0.3)   0.8908              
                         Recall         0.1051 (0.31)  0.8031              
                         F1             0.1027         0.8447              


                    MEDICATION.aspirin
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.5123 (0.49)  0.9175              
                         Recall         0.535 (0.5)    0.99                
                         F1             0.5234         0.9524              


                    MEDICATION.beta_blocker
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.5227 (0.49)  0.8956              
                         Recall         0.5564 (0.5)   0.9653              
                         F1             0.539          0.9291              


                    MEDICATION.calcium_channel_blocker
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.2374 (0.42)  0.9037              
                         Recall         0.2549 (0.44)  0.9506              
                         F1             0.2458         0.9266              


                    MEDICATION.diuretic
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1375 (0.34)  0.7599              
                         Recall         0.1513 (0.36)  0.8346              
                         F1             0.144          0.7955              


                    MEDICATION.dpp4_inhibitors
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


                    MEDICATION.ezetimibe
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


                    MEDICATION.fibrate
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.03113 (0.17) 1.0                 
                         Recall         0.03113 (0.17) 0.5333              
                         F1             0.03113        0.6957              


                    MEDICATION.insulin
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.2497 (0.43)  0.8443              
                         Recall         0.2626 (0.44)  0.9747              
                         F1             0.256          0.9048              


                    MEDICATION.metformin
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.2289 (0.41)  0.8519              
                         Recall         0.2526 (0.43)  0.9461              
                         F1             0.2402         0.8966              


                    MEDICATION.niacin
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


                    MEDICATION.nitrate
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1719 (0.37)  0.8404              
                         Recall         0.1754 (0.38)  0.8745              
                         F1             0.1736         0.8571              


                    MEDICATION.statin
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.5156 (0.49)  0.9266              
                         Recall         0.535 (0.5)    0.9731              
                         F1             0.5251         0.9493              


                    MEDICATION.sulfonylureas
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1725 (0.37)  0.8956              
                         Recall         0.179 (0.38)   0.9236              
                         F1             0.1757         0.9094              


                    MEDICATION.thiazolidinedione
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.03761 (0.19) 0.8406              
                         Recall         0.0428 (0.2)   0.9508              
                         F1             0.04004        0.8923              


                    MEDICATION.thienopyridine
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1783 (0.38)  0.89                
                         Recall         0.1926 (0.39)  0.9683              
                         F1             0.1852         0.9275              


                    SMOKER.current
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.02724 (0.16) 0.3889              
                         Recall         0.02724 (0.16) 0.4242              
                         F1             0.02724        0.4058              


                    SMOKER.past
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1907 (0.39)  0.6533              
                         Recall         0.1907 (0.39)  0.8673              
                         F1             0.1907         0.7452              


                    SMOKER.ever
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.0 (0.0)      0.0                 
                         Recall         0.0 (0.0)      0.0                 
                         F1             nan            0.0                 


                    SMOKER.never
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.1829 (0.39)  0.8246              
                         Recall         0.1829 (0.39)  0.7833              
                         F1             0.1829         0.8034              


                    SMOKER.unknown
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.4611 (0.5)   0.8843              
                         Recall         0.4611 (0.5)   0.9753              
                         F1             0.4611         0.9276              


                    FAMILY_HIST.present
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.003891 (0.062)0.2                 
                         Recall         0.003891 (0.062)0.1053              
                         F1             0.003891       0.1379              


                    FAMILY_HIST.not_present
---------------------------------------------------------------------------
 (514)                   Measure        Macro (SD)     Micro (Primary)     
---------------------------------------------------------------------------
Total                    Precision      0.9475 (0.22)  0.9663              
                         Recall         0.9475 (0.22)  0.9838              
                         F1             0.9475         0.975                         
